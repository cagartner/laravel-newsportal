<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;

use App\Http\Requests;
use App\Http\Controllers\Controller;

use App\Section;
use App\News;
use App\News_features;
use App\News_photo_album;
use App\News_photo_album_photos;
use App\News_sections;
use App\News_tags;
use App\News_video_album;
use App\News_video_album_videos;
use App\NewsBasicPhoto;

class HomeController extends Controller
{
    /**
     * Display a listing of the resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function index()
    {
        $sections = Section::where('activation', '=', 1)->get();
        $news_load = News::with('basic_photo')->with('sections')->with('features')->with('valbums')->where('status', '=', 1)->orderBy('id', 'desc')->take(20)->get();
        $valbums_videos = News_video_album_videos::all();
        $last_news = News::with('sections')->with('basic_photo')->where('status', '=', 1)->orderBy('id', 'desc')->take(20)->get();
        return view('frontend.home', compact('news_load', 'last_news', 'sections', 'valbums_videos'));
    }

    /**
     * Show the form for creating a new resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function section_view(){
        $url = $_SERVER['REQUEST_URI'];
        $tokens = explode('/', $url);
        $section_link = $tokens[2];
        $custom_url = $section_link;
        $path = str_replace('-', ' ', $custom_url);
        $sections = Section::where('activation', '=', 1)->where('id', '=', 1)->first();
        $section_id = 1;//$section_id = $sections['atrributes']['id'];
        $news = News::with('sections')->with('basic_photo')->where('status', '=', 1)->orderBy('id', 'desc')->paginate(20);
        return view('frontend.sections.list_section', compact('news', 'sections', 'section_id'));
    }

    /**
     * Show the form for creating a new resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function news(){
        $url = $_SERVER['REQUEST_URI'];
        $tokens = explode('/', $url);
        $path = $tokens[2];
        $news = News::with('sections')->with('basic_photo')->where('status', '=', 1)->where('id', '=', 61)->orderBy('id', 'desc')->paginate(20);
        return view('frontend.sections.section-topic-details', compact('news'));
    }

    /**
     * Show the form for creating a new resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function create()
    {
        return view('backend.dashboard');
    }

    /**
     * Store a newly created resource in storage.
     *
     * @param  \Illuminate\Http\Request  $request
     * @return \Illuminate\Http\Response
     */
    public function store(Request $request)
    {
        //
    }

    /**
     * Display the specified resource.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function show($id)
    {
        //
    }

    /**
     * Show the form for editing the specified resource.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function edit($id)
    {
        //
    }

    /**
     * Update the specified resource in storage.
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function update(Request $request, $id)
    {
        //
    }

    /**
     * Remove the specified resource from storage.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function destroy($id)
    {
        //
    }
}
